---
title: æ–‡æœ¬å¤„ç†
date: 2021-09-30 13:39:35
description: è®°å½•ä¸€äº›å·¥ä½œä¸­å®é™…ä½¿ç”¨åˆ°çš„ä¸€äº›æ–‡æœ¬å¤„ç†ç›¸å…³å†…å®¹ã€‚
tags:
    è‡ªç„¶è¯­è¨€å¤„ç†
categories:
    ç®—æ³•
mathjax:
    true
---

# æ•æ„Ÿè¯è¿‡æ»¤

ä½¿ç”¨å­—å…¸æ ‘+KMPç®—æ³•ã€‚å­—å…¸çš„å­èŠ‚ç‚¹ä½¿ç”¨hashmapä»¥åŠ é€Ÿã€‚åœ¨å­—å…¸ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä¸­å¢åŠ KMPä¸­çš„åç§»ã€‚ä¸ºäº†ä½¿å¾—å¯ä»¥åŒ¹é…å‡ºå¤šä¸ªå­—ç¬¦ï¼Œå¯ä»¥åœ¨å­—å…¸æ ‘çš„æ ¹èŠ‚ç‚¹ä¹Ÿè®¾ç½®åç§»ï¼Œè§£å†³ç±»ä¼¼å¦‚ä¸‹æƒ…å†µ

```
æ•æ„Ÿè¯ï¼š
ABCD
BCDE

æŸ¥è¯¢ä¸²
ABCDEF
```

åœ¨æ ¹èŠ‚ç‚¹ä¸­è®¾ç½®åç§»ï¼Œå¯ä»¥æŸ¥è¯¢å‡ºå…¨éƒ¨å‡ºç°çš„ä¸¤ä¸ªæ•æ„Ÿè¯ã€‚

ä¸ºäº†èƒ½å¤Ÿå¤„ç†å‡ºç°å¤šä¸ªè¯æ‰ä¼šå‘½ä¸­çš„æƒ…å†µï¼Œä¾‹å¦‚

```
æ•æ„Ÿè¯ï¼š
ABC&CD
```

å³å‡ºç°è¿™ä¸¤ä¸ªæ—¶æ‰è¿‡æ»¤æ‰ã€‚è¿™æ—¶ï¼Œå¯ä»¥åœ¨æ ¹èŠ‚ç‚¹å»ºç«‹ä¸€ä¸ªå­—å…¸ï¼Œå…¶ä¸­keyè¡¨ç¤ºç¬¬å‡ ä¸ªå¹²é¢„è¯ï¼Œvalueè¡¨ç¤ºéœ€è¦å‡ºç°çš„termæ•°é‡ã€‚è¿™æ˜¯ä¸ºäº†è§£å†³å¦‚ä¸‹æƒ…å†µçš„é—®é¢˜

```
ABC&DEF
DEF&XYZ
```

æ­¤æ—¶å¯¹äºDEFå­—å…¸æ ‘çš„ç»ˆèŠ‚ç‚¹ï¼ˆFï¼‰å°±æœ‰åº”è¯¥æ˜¯`{1:2, 2:2}`ã€‚è¿™é‡Œè¡¨ç¤ºï¼Œç¬¬ä¸€ä¸ªæ•æ„Ÿè¯è¿‡æ»¤éœ€è¦ä¸¤ä¸ªtermï¼ˆå…¶è‡ªèº«ä¸ºå…¶ä¸­ä¸€ä¸ªï¼‰ï¼Œç¬¬äºŒä¸ªæ•æ„Ÿè¯è¿‡æ»¤ä¹Ÿéœ€è¦ä¸¤ä¸ªã€‚



# ä¸­æ–‡åˆ‡è¯

å‚è€ƒjiebaåšçš„ä¸­æ–‡åˆ‡è¯ï¼Œjiebaå­˜åœ¨ä¸¤ç§æ–¹å¼ã€‚ä¸€ä¸ªæ˜¯è¯å…¸æŸ¥æ‰¾ï¼Œå¦ä¸€ä¸ªæ˜¯hmmï¼ˆéšé©¬å°”å¯å¤«é“¾ï¼‰ã€‚

## ç”Ÿæˆå¼ä¸åˆ¤åˆ«å¼

åœ¨æœºå™¨å­¦ä¹ ä¸­ä»»åŠ¡æ˜¯ä»å±æ€§Xé¢„æµ‹æ ‡è®°Yï¼Œåˆ¤åˆ«æ¨¡å‹æ±‚çš„æ˜¯P(Y|X)ï¼Œå³åéªŒæ¦‚ç‡ï¼›è€Œç”Ÿæˆæ¨¡å‹æœ€åæ±‚çš„æ˜¯P(X,Y)ï¼Œå³è”åˆæ¦‚ç‡ã€‚ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼š

**åˆ¤åˆ«æ¨¡å‹ä¹‹æ‰€ä»¥ç§°ä¸ºâ€œåˆ¤åˆ«â€æ¨¡å‹**ï¼Œæ˜¯å› ä¸ºå…¶æ ¹æ®Xâ€œåˆ¤åˆ«â€Yï¼›

è€Œ**ç”Ÿæˆæ¨¡å‹ä¹‹æ‰€ä»¥ç§°ä¸ºâ€œç”Ÿæˆâ€æ¨¡å‹**ï¼Œæ˜¯å› ä¸ºå…¶é¢„æµ‹çš„æ ¹æ®æ˜¯è”åˆæ¦‚ç‡P(X,Y)ï¼Œè€Œè”åˆæ¦‚ç‡å¯ä»¥ç†è§£ä¸ºâ€œç”Ÿæˆâ€(X,Y)æ ·æœ¬çš„æ¦‚ç‡åˆ†å¸ƒï¼ˆæˆ–ç§°ä¸º ä¾æ®ï¼‰ï¼›å…·ä½“æ¥è¯´ï¼Œæœºå™¨å­¦ä¹ å·²çŸ¥Xï¼Œä»Yçš„å€™é€‰é›†åˆä¸­é€‰å‡ºä¸€ä¸ªæ¥ï¼Œå¯èƒ½çš„æ ·æœ¬æœ‰$(X,Y_1), (X,Y_2), (X,Y_3),â€¦â€¦ï¼Œ(X,Y_n)$,å®é™…æ•°æ®æ˜¯å¦‚ä½•â€œç”Ÿæˆâ€çš„ä¾èµ–äºP(X,Y)ï¼Œé‚£ä¹ˆæœ€åçš„é¢„æµ‹ç»“æœé€‰å“ªä¸€ä¸ªYå‘¢ï¼Ÿé‚£å°±é€‰â€œç”Ÿæˆâ€æ¦‚ç‡æœ€å¤§çš„é‚£ä¸ªã€‚

å¯¹äºä½¿ç”¨ç”Ÿæˆå¼ï¼Œå…¶å®æ±‚å–çš„æ˜¯é—´æ¥çš„P(Y|X)ã€‚ç”±äº
$$
P(X,Y) = P(Y|X) * P(X) = P(X|Y)*P(Y)
$$
å¯¹äºP(X)æ¥è¯´ï¼Œç”±äºXä¸ºè¾“å…¥ï¼Œå¯¹äºæ‰€æœ‰çš„è¾“å‡ºYæ¥è¯´ï¼ŒP(X)æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤ï¼Œæ±‚P(X,Y)çš„æœ€å¤§å°±æ˜¯æ±‚P(Y|X)çš„æœ€å¤§å€¼ã€‚è€Œä¸”åœ¨ç”Ÿæˆå¼ä¸­ç›¸å¯¹æ¥è¯´ï¼ŒP(X|Y)å’ŒP(Y)æ›´å®¹æ˜“è·å–åˆ°ï¼Œæ‰€ä»¥ä½¿ç”¨ç”Ÿæˆå¼æ¥é—´æ¥æ±‚å–P(Y|X)ã€‚

å‡è®¾æœ‰å››ä¸ªsamples(xä¸ºè¾“å…¥ï¼Œyä¸ºè¾“å‡º)ï¼š 

|      | sample1 | sample1 | sample1 | sample1 |
| ---- | ------- | ------- | ------- | ------- |
| x    | 0       | 0       | 1       | 1       |
| y    | 0       | 0       | 0       | 1       |

ç”Ÿæˆå¼æ¨¡å‹çš„ä¸–ç•Œæ˜¯è¿™ä¸ªæ ·å­ï¼š

|      | y=0  | y=1  |
| ---- | ---- | ---- |
| x=0  | 1/2  | 0    |
| x=1  | 1/4  | 1/4  |

å³ï¼š
$$
\sum{P(x,y) = 1}
$$

æ±‚å–çš„æ˜¯è”åˆæ¦‚ç‡åˆ†å¸ƒã€‚

è€Œåˆ¤å®šå¼æ¨¡å‹çš„ä¸–ç•Œæ˜¯è¿™ä¸ªæ ·å­ï¼š

|      | y=0  | y=1  |
| ---- | ---- | ---- |
| x=0  | 1    | 0    |
| x=1  | 1/2  | 1/2  |

$$
\sum{P(y|x)} = 1
$$

å³åˆ¤åˆ«å¼æ±‚å–çš„æ˜¯æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒã€‚

### ç”Ÿæˆå¼æ±‚è§£

å®šä¹‰è®­ç»ƒé›†ä¸ºï¼ˆCï¼ŒXï¼‰ï¼ŒC={c1,c2,...cn}æ˜¯nä¸ªæ ·æœ¬çš„labelï¼ŒX={x1,x2,...xn}æ˜¯nä¸ªè®­ç»ƒæ ·æœ¬çš„featureï¼Œå®šä¹‰å•ä¸ªæµ‹è¯•æ•°æ®ä¸º(c,x)ã€‚

è®­ç»ƒå®Œæˆåï¼Œè¾“å…¥æµ‹è¯•æ•°æ®ï¼Œåˆ¤åˆ«å¼ç›´æ¥ç»™å‡ºP(c|x)ï¼Œå³è¾“å‡ºï¼ˆlabelï¼‰å…³äºè¾“å…¥ï¼ˆfeatureï¼‰çš„æ¡ä»¶åˆ†å¸ƒï¼Œå®é™…ä¸Šï¼Œè¿™ä¸ªåˆ†å¸ƒçš„æ¡ä»¶è¿˜æœ‰è®­ç»ƒæ•°æ®ï¼Œå› ä¸ºå®é™…ä¸Šæˆ‘ä»¬æ˜¯â€œçœ‹è¿‡â€è®­ç»ƒæ•°æ®ä¹‹åï¼Œå­¦ä¹ åˆ°äº†å¯¹æ•°æ®åˆ†å¸ƒçš„åéªŒè®¤è¯†ï¼Œç„¶åæ ¹æ®è¿™ä¸ªè®¤è¯†å’Œæµ‹è¯•æ ·æœ¬çš„featureæ¥åšå‡ºæµ‹è¯•æ ·æœ¬å±äºå“ªä¸ªlabelçš„å†³ç­–çš„ï¼Œæ‰€ä»¥æœ‰
$$
P(c|x) = P(c|x,C,X)=P(c|x,\theta_{max})
$$
å³ä¾æ®è®­ç»ƒé›†è®­ç»ƒå‡ºæœ€å¤§å‡†ç¡®ç‡çš„æ¨¡å‹è¿›è¡Œä½¿ç”¨ã€‚

### åˆ¤åˆ«å¼æ±‚è§£

ç»™å®šè¾“å…¥xï¼Œç”Ÿæˆæ¨¡å‹å¯ä»¥ç»™å‡ºè¾“å…¥å’Œè¾“å‡ºçš„è”åˆåˆ†å¸ƒã€‚ç”Ÿæˆæ–¹æ³•çš„ç›®æ ‡æ˜¯æ±‚å‡ºè¿™ä¸ªè”åˆåˆ†å¸ƒã€‚è¿™é‡Œä»¥æœ´ç´ è´å¶æ–¯æ¨¡å‹ä¸ºä¾‹ï¼Œæˆ‘ä»¬è¦æ±‚çš„ç›®æ ‡å¯ä»¥é€šè¿‡ï¼š
$$
P(x,c) = P(x|c) * P(c)
$$
è¿™æ ·å°†æ±‚è”åˆåˆ†å¸ƒçš„é—®é¢˜è½¬åŒ–æˆäº†æ±‚ç±»åˆ«å…ˆéªŒæ¦‚ç‡å’Œç±»åˆ«æ¡ä»¶æ¦‚ç‡çš„é—®é¢˜ï¼Œæœ´ç´ è´å¶æ–¯æ–¹æ³•åšäº†ä¸€ä¸ªè¾ƒå¼ºçš„å‡è®¾--------featureçš„ä¸åŒç»´åº¦æ˜¯ç‹¬ç«‹åˆ†å¸ƒçš„ï¼Œç®€åŒ–äº†ç±»åˆ«æ¡ä»¶æ¦‚ç‡çš„è®¡ç®—ã€‚

## è¯å…¸åˆ‡è¯æ–¹å¼ï¼ˆUni-gramï¼‰

é¦–å…ˆå»ºç«‹è¯æ§½å­—å…¸ï¼Œæ¯”å¦‚å¦‚ä¸‹æ ·å¼ï¼š

```
...
åŒ—äº¬å¤§å­¦ 2053
åŒ—äº¬å¤§ 0
å¤§å­¦ 20025
å» 123402
ç© 4207
åŒ—äº¬ 34488
åŒ— 17860
äº¬ 6583
å¤§ 144099
å­¦ 17482
...
```

è¿™é‡Œï¼Œå‰é¢æ˜¯è¯æ§½ï¼Œåé¢æ˜¯å‡ºç°æ¦‚ç‡ã€‚

å¯¼å…¥è¯¥è¯å…¸é…ç½®ï¼Œå»ºç«‹ä¸€ä¸ªå‰ç¼€è¯è¯å…¸ã€‚è¿™é‡Œæˆ‘è§‰å¾—å»ºç«‹ä¸€ä¸ªå­—å…¸æ ‘æ›´åˆé€‚ï¼Œåœ¨è¯å…¸çš„æœ€åä¸€ä¸ªå­ä¸­æ ‡è¯†ä¸ºç»ˆç‚¹ï¼Œå¹¶ä¸”åŒ…å«å…¶æ¦‚ç‡ã€‚

ä¹‹åå¯¹å¾…åˆ‡è¯çš„æ–‡æœ¬è¿›è¡Œå‰ç¼€è¯æŸ¥æ‰¾ï¼Œå³å°†å¾…åŒ¹é…çš„æ–‡æœ¬çš„æ¯ä¸€ä¸ªå­—ç¬¦ä½œä¸ºèµ·å§‹å­—ç¬¦ï¼Œåœ¨å‰ç¼€è¯å…¸ä¸­è¿›è¡Œå‰ç¼€åŒ¹é…æŸ¥æ‰¾ï¼Œå¯¹äºå­—å…¸æ ‘æ¥è¯´ï¼Œéœ€è¦éå†åˆ°æ‰€ä»¥èŠ‚ç‚¹ï¼ˆä¿è¯æ‰¾åˆ°æ‰€æœ‰çš„åˆ‡è¯ï¼Œè€Œä¸èƒ½æ˜¯æ‰¾åˆ°ä¸€ä¸ªæœ«å°¾èŠ‚ç‚¹å°±ç›´æ¥è¿”å›ï¼‰ã€‚ä¸ºäº†åŠ å¿«é€Ÿåº¦ï¼Œå­—å…¸æ ‘ä¸­ï¼Œå­èŠ‚ç‚¹å¯ä»¥ä½¿ç”¨hashmapè¿›è¡Œå­˜å‚¨ã€‚è¿™æ ·å¯ä»¥ç›´æ¥è¿›è¡ŒæŸ¥æ‰¾ï¼ŒåŠ å¿«é€Ÿåº¦ã€‚æ­¤æ—¶å¯¹äºå¾…åŒ¹é…çš„æ–‡æœ¬ï¼Œä¼šç”Ÿæˆä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼Œä¾‹å¦‚ï¼š

![img](https://pic4.zhimg.com/80/v2-b9b914067209c1d6b4a9cd8279ac77ff_1440w.jpg)

å¯¹äºæ¯ä¸€ä¸ªå­—ç¬¦ï¼Œå…¶å­˜å‚¨çš„æ˜¯ä»å½“å‰èŠ‚ç‚¹åˆ°åˆ‡è¯æœ«å°¾èŠ‚ç‚¹çš„è¾¹ã€‚å¯¹äºä¸Šå›¾çš„å­˜å‚¨å¤§è‡´ä¸ºï¼š

```
0: [0]
1: [1,2,4]
2: [2]
3: [3,4]
4: [4]
5: [5]
```

å­˜å‚¨æœ«å°¾ä½ç½®çš„åŒæ—¶ï¼Œä¹Ÿè¦å­˜å‚¨å¯¹åº”çš„æ¦‚ç‡ï¼Œè¿™æ˜¯ä¸ºäº†è®¡ç®—æœ€ä¼˜è·¯å¾„ã€‚

æ„å»ºäº†æœ‰å‘æ— ç¯å›¾åï¼Œå°±å¯ä»¥æ‰¾åˆ°ä»èµ·å§‹åˆ°æœ«å°¾çš„å¤šæ¡å¯é€‰è·¯å¾„ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ±‚è§£æ¦‚ç‡æœ€å¤§è·¯å¾„ï¼Œå…¶ä¸­è½¬ç§»å‡½æ•°ä¸ºï¼š

```
dp[i] = max(dp[k] + p[i][k])
```

å…¶ä¸­kä¸ºä»èŠ‚ç‚¹iå‡ºå‘å¯ä»¥åˆ°è¾¾çš„èŠ‚ç‚¹kã€‚ä½†ç”±äºæˆ‘ä»¬åªå­˜å‚¨äº†ç”±å‰åˆ°åçš„è¾¹ï¼Œæœªå­˜å‚¨ä»ååˆ°å‰çš„èŠ‚ç‚¹ï¼Œå› æ­¤åœ¨åŠ¨æ€è§„åˆ’æ—¶ï¼Œéœ€è¦ä»æœ€åä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œè®¡ç®—ã€‚åœ¨è¿›è¡Œè®¡ç®—æœ€å¤§æ¦‚ç‡è·¯å¾„åŒæ—¶å­˜å‚¨æœ€ä¼˜è·¯å¾„ï¼Œå½“è®¡ç®—åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ—¶å³è·å–åˆ°æœ€ä¼˜åˆ‡è¯ç»“æœã€‚

## HMMï¼ˆéšé©¬å°”å¯å¤«é“¾ï¼‰

ä¸Šè¿°çš„æ–¹æ³•åªèƒ½å¤„ç†åœ¨è¯å…¸ä¸­å‡ºç°çš„è¯ï¼Œå¯¹äºè¯å…¸ä¸­æœªå‡ºç°çš„è¯å…¶æ•ˆæœå¾ˆå·®ã€‚å› æ­¤è¿™é‡Œå¯ä»¥ä½¿ç”¨HMMæ¥å¤„ç†æœªå‡ºç°åœ¨è¯å…¸ä¸­çš„queryï¼ˆå‡ºç°æœªå‡ºç°éƒ½å¯ä»¥ï¼‰ã€‚

HMMæ˜¯ç”Ÿæˆå¼ã€‚

åˆ©ç”¨HMMæ¨¡å‹è¿›è¡Œåˆ†è¯ï¼Œä¸»è¦æ˜¯å°†åˆ†è¯é—®é¢˜è§†ä¸ºä¸€ä¸ªåºåˆ—æ ‡æ³¨ï¼ˆsequence labelingï¼‰é—®é¢˜ï¼Œå…¶ä¸­ï¼Œå¥å­ä¸ºè§‚æµ‹åºåˆ—ï¼Œåˆ†è¯ç»“æœä¸ºçŠ¶æ€åºåˆ—ã€‚é¦–å…ˆé€šè¿‡è¯­æ–™è®­ç»ƒå‡ºHMMç›¸å…³çš„æ¨¡å‹ï¼Œç„¶ååˆ©ç”¨Viterbiç®—æ³•è¿›è¡Œæ±‚è§£ï¼Œæœ€ç»ˆå¾—åˆ°æœ€ä¼˜çš„çŠ¶æ€åºåˆ—ï¼Œç„¶åå†æ ¹æ®çŠ¶æ€åºåˆ—ï¼Œè¾“å‡ºåˆ†è¯ç»“æœã€‚

åºåˆ—æ ‡æ³¨ï¼Œå°±æ˜¯å°†è¾“å…¥å¥å­å’Œåˆ†è¯ç»“æœå½“ä½œä¸¤ä¸ªåºåˆ—ï¼Œ**å¥å­ä¸ºè§‚æµ‹åºåˆ—**ï¼Œ**åˆ†è¯ç»“æœä¸ºçŠ¶æ€åºåˆ—**ï¼Œå½“å®ŒæˆçŠ¶æ€åºåˆ—çš„æ ‡æ³¨ï¼Œä¹Ÿå°±å¾—åˆ°äº†åˆ†è¯ç»“æœã€‚

æ¯ä¸ªå­—å¤„åœ¨è¯è¯­ä¸­çš„4ç§å¯èƒ½çŠ¶æ€ï¼ŒBã€Mã€Eã€Sï¼Œåˆ†åˆ«è¡¨ç¤ºBeginï¼ˆè¿™ä¸ªå­—å¤„äºè¯çš„å¼€å§‹ä½ç½®ï¼‰ã€Middleï¼ˆè¿™ä¸ªå­—å¤„äºè¯çš„ä¸­é—´ä½ç½®ï¼‰ã€Endï¼ˆè¿™ä¸ªå­—å¤„äºè¯çš„ç»“æŸä½ç½®ï¼‰ã€Singleï¼ˆè¿™ä¸ªå­—æ˜¯å•å­—æˆè¯ï¼‰ã€‚

ä½¿ç”¨HMMåŸºäºä¸¤ç‚¹å‡è®¾(sä¸ºçŠ¶æ€ï¼Œoä¸ºè§‚æµ‹)ï¼š

**é½æ¬¡é©¬å°”ç§‘å¤«æ€§å‡è®¾**ï¼Œå³å‡è®¾éšè—çš„é©¬å°”ç§‘å¤«é“¾åœ¨ä»»æ„æ—¶åˆ»tçš„çŠ¶æ€åªä¾èµ–äºå…¶å‰ä¸€æ—¶åˆ»çš„çŠ¶æ€ï¼Œä¸å…¶å®ƒæ—¶åˆ»çš„çŠ¶æ€åŠè§‚æµ‹æ— å…³ï¼Œä¹Ÿä¸æ—¶åˆ»tæ— å…³ï¼›
$$
P(s_{i+1}|s_1,s_2,...s_n, o_1, o_2, ...o_n) = P(s_{i+1}|s_i) 
$$
**è§‚æµ‹ç‹¬ç«‹æ€§å‡è®¾**ï¼Œå³å‡è®¾ä»»æ„æ—¶åˆ»çš„è§‚æµ‹åªä¾èµ–äºè¯¥æ—¶åˆ»çš„é©¬å°”ç§‘å¤«é“¾çš„çŠ¶æ€ï¼Œä¸å…¶å®ƒè§‚æµ‹å’ŒçŠ¶æ€æ— å…³ï¼Œ
$$
P(o_i|s_1,s_2,...s_n,o_1, o_2, ... o_n) = P(o_i|s_i)
$$
å¯¹äºéšé©¬å°”ç§‘å¤«è®²è§£å¯ä»¥çœ‹ä¸‹å¦‚ä¸‹æ–‡æ¡£ï¼š

https://zhuanlan.zhihu.com/p/31926943

https://zhuanlan.zhihu.com/p/31943292

https://zhuanlan.zhihu.com/p/31999081

https://zhuanlan.zhihu.com/p/32080000

æœ€ç»ˆæˆ‘ä»¬æ±‚è§£çš„æ˜¯å¯¹äºç»™å®šçš„è§‚å¯Ÿåºåˆ—O(o1,o2,...oTï¼Œè·å–å…¶ä¸çŠ¶æ€åºåˆ—I(s1,s2,...sT)çš„è”åˆåˆ†å¸ƒæ¦‚ç‡æœ€å¤§å€¼ï¼Œå³
$$
P(O,I) = P(o_1,o_2,...o_T,s_1,s_2,...s_T)=P(O,I) = P(O|I)*P(I)
$$
ç”±äº
$$
P(AB|C) = P(ABC)/P(C) = \frac{P(ABC)/P(BC)}{P(C)/P(BC)} = P(A|BC)*P(B|C)
$$
å°†Oé€’å½’æ‹†åˆ†ä¸ºABä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€æ¬¡åˆ’åˆ†å¦‚ä¸‹ï¼š
$$
P(O|I) = P(o_1,o2,...o_{T-1}, o_T|I)=P(o_1,o_2,...o_{T-1}|o_T,I)*P(o_T|I)
$$
**è§‚æµ‹ç‹¬ç«‹æ€§å‡è®¾**ï¼Œä¸Šå¼å˜æ¢ä¸º
$$
P(o_1,o_2,...o_{T-1}|o_T,I)*P(o_T|I)=P(o_1,o_2,...o_{T-1}|o_T,I)*P(o_T|s_T)
$$
ä¹‹åé€’å½’çš„å¯¹ä¸Šå¼ä¸­å‰ä¸€éƒ¨åˆ†è¿›è¡Œæ‹†åˆ†
$$
P(o_1,o_2,...o_{T-1}|o_T,I) = p(o_1,o_2,...o_{T-2}|o_{T-1},o_T,I)*P(o_{T-1}|o_T,I)=p(o_1,o_2,...o_{T-2}|o_{T-1},o_T,I)*P(o_{T-1}|s_{T-1})
$$
é€šè¿‡ä¸æ–­é€’å½’æ‹†åˆ†ï¼Œæœ€ç»ˆå¾—åˆ°
$$
P(O|I) = P(o_1|s_1)*P(o_2|s_2)*...*P(o_T|s_T)
$$
æ‰€ä»¥
$$
P(O,I) =P(o_1|s_1)*P(o_2|s_2)*...*P(o_T|s_T)*P(I)
$$
å¯¹äºP(I)æ¥è¯´
$$
P(I) = P(s_1,s_2,...s_T) = P(s_T|s_1,s_2,...s_{T-1})*P(s_1,s_2,...s_{T-1})
$$
ç”±äº**é½æ¬¡é©¬å°”ç§‘å¤«æ€§å‡è®¾**
$$
P(s_T|s_1,s_2,...s_{T-1})*P(s_1,s_2,...s_{T-1}) = P(s_T|s_{T-1})*P(s1,s2,...s_{T-1})
$$
ä¹‹åå¯¹ä¸Šå¼ä¸­ååŠéƒ¨åˆ†ç»§ç»­æ‰§è¡Œä¸Šè¿°å˜æ¢ï¼Œåˆ™å¾—åˆ°
$$
P(I)  = P(s_1)*P(s_2|s_1)*...*P(s_{T-1}|s_T)
$$
äºæ˜¯ï¼Œå¾—åˆ°æœ€ç»ˆçš„æ¦‚ç‡å‡½æ•°
$$
P(O,I) =P(o_1|s_1)*P(o_2|s_2)*...*P(o_T|s_T)*P(s_1)*P(s_2|s_1)*...*P(s_{T-1}|s_T)
$$
æ‰€ä»¥ä½¿ç”¨HMMæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸‰éƒ¨åˆ†å€¼ï¼š

1. P(oi|si)ï¼šå‘å°„æ¦‚ç‡ã€‚å½“å¤„äºçŠ¶æ€siæ—¶ï¼Œè§‚å¯Ÿå€¼ï¼ˆå³å­—ç¬¦ä¸ºoiï¼‰çš„æ¦‚ç‡ã€‚
2. P(Si-1|si): è½¬ç§»æ¦‚ç‡ã€‚å³å¯¹äºi-1çš„çŠ¶æ€ä¸ºsi-1æ—¶ï¼Œiçš„çŠ¶æ€ä¸ºsiçš„æ¦‚ç‡ã€‚
3. P(s1): åˆå§‹çŠ¶æ€æ¦‚ç‡ã€‚å³ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºçŠ¶æ€s1çš„æ¦‚ç‡ã€‚

ä¸Šè¿°3éƒ¨åˆ†å€¼çš„è·å–å°±æ˜¯å¯¹HMMæ¨¡å‹çš„è®­ç»ƒï¼Œjiebaè·å–æ–¹å¼æ˜¯æ‹¿98å¹´æŠ¥çº¸å’Œå…¶ä»–æ‚å¿—ä¿¡æ¯ä¸­çš„åˆ‡è¯ï¼Œç»Ÿè®¡è¯é¢‘ï¼Œè·å–å¯¹åº”æ¯ä¸€éƒ¨åˆ†çš„æ¦‚ç‡ã€‚è¿™ä¸‰éƒ¨åˆ†æ¦‚ç‡å‡å­˜å‚¨äºæ–‡ä»¶ä¸­ï¼Œå¯¹åº”æ ¼å¼å¦‚ä¸‹ã€‚æ¦‚ç‡å€¼éƒ½æ˜¯å–å¯¹æ•°ä¹‹åçš„ç»“æœï¼ˆå¯ä»¥è®©æ¦‚ç‡ç›¸ä¹˜è½¬å˜ä¸ºæ¦‚ç‡ç›¸åŠ ï¼‰ï¼Œå…¶ä¸­-3.14e+100ä»£è¡¨è´Ÿæ— ç©·ï¼Œå¯¹åº”çš„æ¦‚ç‡å€¼å°±æ˜¯0ã€‚

1. å‘å°„æ¦‚ç‡

   ```
   P={'B': {'ä¸€': -3.6544978750449433,
   'ä¸': -8.125041941842026,
   'ä¸ƒ': -7.817392401429855,
   ...
   'S': {':': -15.828865681131282,
   'ä¸€': -4.92368982120877,
   'ä¸': -9.024528361347633,
   ...
   ```

   P['B']\['ä¸€']ä»£è¡¨çš„å«ä¹‰å°±æ˜¯çŠ¶æ€å¤„äº'B'ï¼Œè€Œè§‚æµ‹çš„å­—æ˜¯â€˜ä¸€â€™çš„æ¦‚ç‡å¯¹æ•°å€¼ä¸ºP['B']['ä¸€'] = -3.6544978750449433

2. è½¬ç§»æ¦‚ç‡

   ```
   P={'B': {'E': -0.510825623765990, 'M': -0.916290731874155},
   'E': {'B': -0.5897149736854513, 'S': -0.8085250474669937},
   'M': {'E': -0.33344856811948514, 'M': -1.2603623820268226},
   'S': {'B': -0.7211965654669841, 'S': -0.6658631448798212}}
   ```

   P[B]\[E]ä»£è¡¨çš„å«ä¹‰å°±æ˜¯ä»çŠ¶æ€Bè½¬ç§»åˆ°çŠ¶æ€Eçš„æ¦‚ç‡ï¼Œç”±P['B']\['E'] = -0.5897149736854513ï¼Œè¡¨ç¤ºå½“å‰çŠ¶æ€æ˜¯Bï¼Œä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯Eçš„æ¦‚ç‡å¯¹æ•°æ˜¯-0.5897149736854513ï¼Œå¯¹åº”çš„æ¦‚ç‡å€¼æ˜¯0.6ï¼Œç›¸åº”çš„ï¼Œå½“å‰çŠ¶æ€æ˜¯Bï¼Œä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯Mçš„æ¦‚ç‡æ˜¯0.4ï¼Œè¯´æ˜å½“æˆ‘ä»¬å¤„äºä¸€ä¸ªè¯çš„å¼€å¤´æ—¶ï¼Œä¸‹ä¸€ä¸ªå­—æ˜¯ç»“å°¾çš„æ¦‚ç‡è¦è¿œé«˜äºä¸‹ä¸€ä¸ªå­—æ˜¯ä¸­é—´å­—çš„æ¦‚ç‡ï¼Œç¬¦åˆæˆ‘ä»¬çš„ç›´è§‰ï¼Œå› ä¸ºäºŒä¸ªå­—çš„è¯æ¯”å¤šä¸ªå­—çš„è¯æ›´å¸¸è§ã€‚

3. åˆå§‹çŠ¶æ€æ¦‚ç‡

   ```
   P={'B': -0.26268660809250016,
   'E': -3.14e+100,
   'M': -3.14e+100,
   'S': -1.4652633398537678}
   ```

   è¿™ä¸ªæ¦‚ç‡è¡¨è¯´æ˜ä¸€ä¸ªè¯ä¸­çš„ç¬¬ä¸€ä¸ªå­—å±äº{Bã€Mã€Eã€S}è¿™å››ç§çŠ¶æ€çš„æ¦‚ç‡ï¼Œå¦‚ä¸‹å¯ä»¥çœ‹å‡ºï¼ŒEå’ŒMçš„æ¦‚ç‡éƒ½æ˜¯0ï¼Œè¿™ä¹Ÿå’Œå®é™…ç›¸ç¬¦åˆï¼šå¼€å¤´çš„ç¬¬ä¸€ä¸ªå­—åªå¯èƒ½æ˜¯æ¯ä¸ªè¯çš„é¦–å­—ï¼ˆBï¼‰ï¼Œæˆ–è€…å•å­—æˆè¯ï¼ˆSï¼‰ã€‚

è·å¾—è¿™ä¸‰éƒ¨åˆ†æ•°æ®åï¼Œé€šè¿‡Viterbiç®—æ³•ï¼ˆåŠ¨æ€è§„åˆ’çš„ä¸€ç§ï¼‰ã€‚

å‡è®¾ç»™å®š[éšå¼é©¬å°”å¯å¤«æ¨¡å‹](https://zh.wikipedia.org/wiki/éšé©¬å°”å¯å¤«æ¨¡å‹)ï¼ˆHMMï¼‰çŠ¶æ€ç©ºé—´Sï¼Œå…±æœ‰kä¸ªçŠ¶æ€ï¼Œåˆå§‹çŠ¶æ€ i çš„æ¦‚ç‡ä¸º P(i) ï¼Œä»çŠ¶æ€i åˆ°çŠ¶æ€ j çš„è½¬ç§»æ¦‚ç‡ä¸º P[i]\[j]ã€‚ ä»¤è§‚å¯Ÿåˆ°çš„è¾“å‡ºä¸º y1,...yTã€‚ äº§ç”Ÿè§‚å¯Ÿç»“æœçš„æœ€æœ‰å¯èƒ½çš„çŠ¶æ€åºåˆ— x1,....xT ç”±é€’æ¨å…³ç³»ç»™å‡ºï¼š
$$
V_{1,k} = P(y_1|k)*P(k)
$$

$$
V_{i,k} = max_{x\in S}(p(y_i|k)*p[x][k]*V_{i-1,k})
$$

é€šè¿‡ä¸Šè¿°ä¸¤å¼å³å¯è¿›è¡ŒåŠ¨æ€è§„åˆ’ï¼Œåœ¨è®¡ç®—ç¬¬äºŒä¸ªå¼å­æ˜¯ï¼Œå­˜å‚¨ä¸‹æ‰€é€‰æ‹©çš„xï¼Œå³é€‰æ‹©çš„å‰ä¸€ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå³å¯ç›´æ¥åœ¨è®¡ç®—å®Œæˆåè·å¾—æœ€ä¼˜çŠ¶æ€åºåˆ—ã€‚å¯¹äºåˆ†è¯æ¥è¯´ï¼Œæœ€åä¸€ä¸ªå­åªå¯èƒ½æ˜¯sæˆ–eï¼Œå› æ­¤å¯¹äºæœ€åä¸€ä¸ªå­ï¼Œåªéœ€è¦æ¯”è¾ƒå…¶çŠ¶æ€ä¸ºså’Œeå¤§å°å³å¯ï¼Œé€‰æ‹©è¾ƒå¤§è€…ï¼Œå³
$$
max(V_{T,E}, V_{T,S})
$$

### å‰å‘åå‘ç®—æ³•è¯„ä¼°è§‚æµ‹åºåˆ—æ¦‚ç‡

é—®é¢˜ï¼šå·²çŸ¥HMMæ¨¡å‹çš„å‚æ•°$\lambda=(A,B,\Pi)$ã€‚å…¶ä¸­ğ´æ˜¯éšè—çŠ¶æ€è½¬ç§»æ¦‚ç‡çš„çŸ©é˜µï¼Œğµæ˜¯è§‚æµ‹çŠ¶æ€ç”Ÿæˆæ¦‚ç‡çš„çŸ©é˜µï¼Œ$\Pi$æ˜¯éšè—çŠ¶æ€çš„åˆå§‹æ¦‚ç‡åˆ†å¸ƒã€‚éšè—çŠ¶æ€çš„çŠ¶æ€ç©ºé—´ä¸ºNã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿå·²ç»å¾—åˆ°äº†è§‚æµ‹åºåˆ—$O=\{o_1,o_2,...o_T\}$,ç°åœ¨æˆ‘ä»¬è¦æ±‚è§‚æµ‹åºåˆ—ğ‘‚åœ¨æ¨¡å‹ğœ†ä¸‹å‡ºç°çš„æ¡ä»¶æ¦‚ç‡$P(O|Î»)$ã€‚

æš´åŠ›ç®—æ³•ä¸º
$$
P(O|\lambda)=\sum_IP(O,I|\lambda)
$$
åˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„Iï¼Œæ±‚å‡ºæ¯ä¸€ä¸ªå¯¹åº”çš„$P(O,I|\lambda)$ã€‚ä½†å¤æ‚åº¦è¿‡é«˜ã€‚å¯¹äºå«æœ‰Nä¸ªéšè—çŠ¶æ€çš„éœ€æ±‚æ¥è¯´ï¼Œå…¶å¤æ‚åº¦ä¸º$O(TN^T)$ã€‚

#### å‰å‘ç®—æ³•æ±‚è§£hmmè§‚æµ‹åºåˆ—æ¦‚ç‡

å‰å‘ç®—æ³•ä¸ºåŠ¨æ€è§„åˆ’ç®—æ³•ï¼Œé€šè¿‡å®šä¹‰å‰å‘æ¦‚ç‡æ¥å®šä¹‰åŠ¨æ€è§„åˆ’è¿™ä¸ªå±€éƒ¨çŠ¶æ€ï¼Œå‰å‘çŠ¶æ€å®šä¹‰ä¸ºï¼šæ—¶åˆ»tæ—¶éšè—çŠ¶æ€ä¸º$q_i$,è§‚æµ‹çŠ¶æ€çš„åºåˆ—ä¸º$o_1,o_2,...o_t$çš„æ¦‚ç‡ï¼Œå³
$$
{\alpha}_t(i) = P(o_1,o_2,...o_t,i_t=q_i|\lambda)
$$
ä¹‹åï¼Œè¿›è¡Œt+1çŠ¶æ€çš„é€’æ¨ã€‚åŸºäºæ—¶åˆ»tçš„å„ä¸ªéšè—çŠ¶æ€çš„å‰å‘æ¦‚ç‡ï¼Œå†ä¹˜ä»¥å¯¹åº”çš„çŠ¶æ€è½¬ç§»æ¦‚ç‡ï¼Œå³${\alpha}_t(j)a_{ji}$å°±æ˜¯æ—¶åˆ»tè§‚æµ‹åˆ°$o_1,o_2,...o_t$,å¹¶ä¸”æ—¶åˆ»téšè—çŠ¶æ€ä¸º$q_j$,æ—¶åˆ»t+1éšè—çŠ¶æ€ä¸º$q_i$çš„æ¦‚ç‡ã€‚å³
$$
{\alpha}_t(j)a_{ji}=P(o_1,o_2,...o_t,i_t=q_j|\lambda)P(i_{t+1}=q_i|i_t=q_j,\lambda)\\=P(o_1,o_2,...o_t,i_t=q_j|\lambda)P(i_{t+1}=q_i|o_1,o_2,...o_t,i_t=q_j,\lambda)\\=P(o_1,o_2,...o_t,i_t=q_j,i_{t+1}=q_i|\lambda)
$$
å°†æ‰€æœ‰çš„tæ—¶åˆ»éšè—çŠ¶æ€ä¹˜ä»¥å¯¹åº”çš„è½¬ç§»æ¦‚ç‡ï¼Œå¹¶è¿›è¡Œæ±‚å’Œ:
$$
\sum_{j=1}^N{\alpha}_t(j)a_{ji}=\sum_{j=1}^NP(o_1,o_2,...o_t,i_t=q_j,i_{t+1}=q_i|\lambda)=P(o_1,o_2,...o_t,i_{t+1}=q_i|\lambda)
$$
å³å¾—åˆ°æ—¶åˆ»tè§‚æµ‹åºåˆ—ä¸º$o_1,o_2,...o_t$,å¹¶ä¸”æ—¶åˆ»t+1æ—¶åˆ»éšè—çŠ¶æ€ä¸º$q_i$çš„æ¦‚ç‡ã€‚ç”±äºè§‚æµ‹çŠ¶æ€åªä¾èµ–äºt+1æ—¶åˆ»çš„éšè—çŠ¶æ€$q_i$ï¼Œå› æ­¤:
$$
[\sum_{j=1}^N{\alpha}_t(j)a_{ji}]b_i(o_{t+1})=P(o_1,o_2,...o_t,i_{t+1}=q_i|\lambda)P(o_{t+1}|i_{t+1}=q_i,\lambda)\\=P(o_1,o_2,...o_t,i_{t+1}=q_i|\lambda)P(o_{t+1}|o_1,o_2,...o_t,i_{t+1}=q_i,\lambda)=P(o_1,o_2,...o_t,o_{t+1},i_{t+1}=q_i|\lambda)
$$
å› æ­¤ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†é€’æ¨å…¬å¼ï¼Œå³
$$
{\alpha}_{t+1}(i)=[\sum_{j=1}^N{\alpha}_t(j)a_{ji}]b_i(o_{t+1})
$$
åŠ¨æ€è§„åˆ’ä»1å¼€å§‹ï¼Œåˆ°æ—¶åˆ»Tç»“æŸï¼Œ${\alpha}_T(i)$è¡¨ç¤ºåœ¨æ—¶åˆ»Tå…³ç³»åºåˆ—ä¸º$o_1,o_2,...o_T$ï¼Œå¹¶ä¸”æ—¶åˆ»Téšè—çŠ¶æ€ä¸º$q_i$çš„æ¦‚ç‡ï¼Œæ‰€ä»¥ï¼Œåªè¦å°†æ‰€ä»¥éšè—çŠ¶æ€å¯¹äºçš„æ¦‚ç‡ç›¸åŠ ï¼Œå³$\sum_{i=1}^N{\alpha}_T(i)$å³å¾—åˆ°æ—¶åˆ»Tè§‚æµ‹åºåˆ—ä¸º$o_1,o_2,...o_T$çš„æ¦‚ç‡ã€‚

æ€»ç»“å‰å‘ç®—æ³•ï¼š

è¾“å…¥ï¼šHMMæ¨¡å‹$\lambda=(A,B,\Pi)$ï¼Œè§‚æµ‹åºåˆ—$O=(o_1,o_2,...o_T)$

è¾“å‡ºï¼šè§‚æµ‹åºåˆ—æ¦‚ç‡$P(O|\lambda)$ã€‚

1. è®¡ç®—æ—¶åˆ»1çš„å„ä¸ªéšè—çŠ¶æ€å‰å‘æ¦‚ç‡ï¼š
   $$
   {\alpha}_1(i)={\pi}_ib_i(o_1)=P(i_1=q_i|\lambda)P(o_1|i_1=q_i,\lambda)=P(o_1,i_1=q_i,\lambda),i=1,2,3,...N
   $$

2. é€’æ¨æ—¶åˆ»2ï¼Œ3ï¼Œ...Tæ—¶åˆ»çš„å‰å‘æ¦‚ç‡ï¼š
   $$
   {\alpha}_{t+1}(i)=[\sum_{j=1}^N{\alpha}_t(j)a_{ji}]b_i(o_{t+1}),i=1,2...N
   $$

3. è®¡ç®—æœ€ç»ˆç»“æœï¼š
   $$
   P(O|\lambda)=\sum_{i=1}^N{\alpha}_T(i)
   $$

ä»é€’æ¨å…¬å¼å¯ä»¥çœ‹å‡ºï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¸º$O(TN^2)$ã€‚

#### åå‘ç®—æ³•æ±‚è§£HMMè§‚æµ‹åºåˆ—æ¦‚ç‡

åå‘ç®—æ³•ä¸å‰å‘ç®—æ³•ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä½¿ç”¨åŠ¨æ€è§„åˆ’æ±‚è§£ï¼Œä¸è¿‡é€‰æ‹©çš„å±€éƒ¨çŠ¶æ€ä¸ºåå‘æ¦‚ç‡ï¼Œåå‘æ¦‚ç‡ä¸ºï¼š
$$
\beta_t(i)=P(o_{t+1},o_{t+2},...o_T|i_t=q_i,\lambda)
$$
é€’æ¨å…¬å¼ä¸ºï¼š
$$
{\beta}_t(i)=\sum_{j=1}^NP(o_{t+1},o_{t+2},...o_T,i_{t+1}=q_j|i_t=q_i,\lambda)\\=\sum_{j=1}^NP(o_{t+1},o_{t+2},...o_T|i_{t+1}=q_j,i_t=q_i,\lambda)P(i_{t+1}|i_t,\lambda)=\sum_{j=1}^NP(o_{t+1},o_{t+2},...o_T|i_{t+1}=q_j,\lambda)P(i_{t+1}|i_t,\lambda)\\=\sum_{j=1}^NP(o_{t+1}|o_{t+2},...o_T,i_{t+1},\lambda)P(o_{t+2},...o_T|i_{t+1},\lambda)P(i_{t+1}=q_j|i_t=q_i)\\=\sum_{j+1}^NP(o_{t+1}|i_{t+1},\lambda)P(o_{t+2},...o_T|i_{t+1},\lambda)P(i_{t+1}=q_j|i_t=q_i)=\sum_{j+1}^Nb_j(o_{t+1}){\beta}_t(i)a_{ij}
$$
åå‘ç®—æ³•æ­¥éª¤ä¸ºï¼š

è¾“å…¥ï¼šHMMæ¨¡å‹$lambda=(A,B,\Pi)$,è§‚æµ‹åºåˆ—$O=(o_1,o_2,...o_T)$ã€‚

è¾“å‡ºï¼šè§‚æµ‹åºåˆ—æ¦‚ç‡$P(O|\lambda)$

1. åˆå§‹åŒ–æ—¶åˆ»Tçš„å„ä¸ªéšè—çŠ¶æ€åå‘æ¦‚ç‡ï¼š
   $$
   {\beta}_T(i)=1, i=1,2,...N,i=1,2,...N
   $$

2. é€’æ¨æ—¶åˆ»T-1,T-2,...1æ—¶åˆ»çš„åå‘æ¦‚ç‡ï¼š
   $$
   {\beta}_t(i)=\sum_{j+1}^Nb_j(o_{t+1}){\beta}_t(i)a_{ij},i=1,2,...N
   $$

3. è®¡ç®—æœ€ç»ˆç»“æœï¼š
   $$
   P(O|\lambda)=\sum_{i=1}^N{\pi}_ib_i(o_1){\beta}_1(i)
   $$

å…¶å¤æ‚åº¦ä¸º$O(TN^2)$ã€‚

#### HMMå¸¸ç”¨æ¦‚ç‡çš„è®¡ç®—

1. ç»™å®šæ¨¡å‹$\lambda$å’Œè§‚æµ‹åºåˆ—$O$ï¼Œåœ¨æ—¶åˆ»tå¤„äºçŠ¶æ€$q_i$çš„æ¦‚ç‡è®°ä¸ºï¼š
   $$
   {\gamma}_t(i)=P(i_t=q_i|O,\lambda)=\frac{P(i_t=q_i,O|\lambda)} {p(O|\lambda)}
   $$
   ç”±äº
   $$
   P(i_t=q_i,O|\lambda)={\alpha}_t(i){\beta}_t(i)=P(o_1,o_2,...o_t,i_t=q_i|\lambda)P(o_{t+1},o_{t+2},...o_T|i_t=q_i,\lambda)\\=P(o_1,o_2,...o_t|i_t=q_i,\lambda)P(o_{t+1},o_{t+2},...o_T|i_t=q_i,\lambda)P(i_t=q_i|\lambda)=P(O|i_t=q_i,\lambda)P(i_t|\lambda)=P(i_t=q_i,O|\lambda)
   $$
   å› æ­¤ï¼š
   $$
   {\gamma}_t(i)=P(i_t=q_i|O,\lambda)=\frac{ {\alpha}_t(i){\beta}_t(i)}{\sum_{j=1}^N{\alpha}_t(i){\beta}_t(i)}
   $$

2. ç»™å®šæ¨¡å‹$\lambda$å’Œè§‚æµ‹åºåˆ—$O$,åœ¨æ—¶åˆ»$t$å¤„äºçŠ¶æ€$q_i$ï¼Œä¸”æ—¶åˆ»t+1å¤„äºçŠ¶æ€$q_j$çš„æ¦‚ç‡è®°ä¸º:
   $$
   {\xi}_i(i,j)=P(i_t=q_i,i_{t+1}=q_j|O,\lambda)=\frac{P(i_t=q_i,i_{t+1}=q_j,O|\lambda)}{P(O|\lambda)}
   $$
   ç”±äº
   $$
   P(i_t=q_i,i_{t+1}=q_j,O|\lambda)\\=P(i_t=q_i,o_1,...o_t|\lambda)P(i_{t+1}=q_j,o_{t+1},...o_T|i_t=q_i,o_1,...o_t,\lambda)\\={\alpha}_t(i)P(i_{t+1}=q_j,o_{t+1},...o_T|i_t=q_i,\lambda)\\={\alpha}_t(i)P(o_{t+2},...o_T|i_{t+1}=q_j,\lambda)P(i_{t+1}=q_j,o_{t+1}|o_{t+2},...o_T,i_t=q_i,\lambda)\\={\alpha}_t(i){\beta}_{t+1}(j)P(i_{t+1}=q_j,o_{t+1}|i_t=q_i,\lambda)\\={\alpha}_t(i){\beta}_{t+1}(j)P(i_{t+1}=q_j|i_t=q_i,\lambda)P(o_{t+1}|i_{t+1}=q_j,i_t=q_i,\lambda)\\={\alpha}_t(i){\beta}_{t+1}(j)a_{ij}b_j(o_{t+1})
   $$
   å› æ­¤
   $$
   {\xi}_i(i,j)=\frac{ {\alpha}_t(i){\beta}_{t+1}(j)a_{ij}b_j(o_{t+1})}{\sum_i^N\sum_j^N{\alpha}_t(i){\beta}_{t+1}(j)a_{ij}b_j(o_{t+1})}
   $$

## EMï¼ˆæœŸæœ›æå¤§ç®—æ³•ï¼‰

EMç®—æ³•ç”¨äºå«æœ‰éšå˜é‡çš„æ¦‚ç‡æ¨¡å‹çš„æå¤§ä¼¼ç„¶ä¼°è®¡æˆ–æå¤§åéªŒæ¦‚ç‡ä¼°è®¡ã€‚EMç®—æ³•åˆ†ä¸ºä¸¤æ­¥ï¼šEæ­¥ï¼Œæ±‚æœŸæœ›ï¼ˆexpectionï¼‰ï¼›Mæ­¥ï¼Œæ±‚æå¤§ï¼ˆmaximizationï¼‰ã€‚

ä¸€èˆ¬çš„ï¼Œå°†Yè¡¨ç¤ºä¸ºè§‚å¯Ÿéšæœºå˜é‡çš„æ•°æ®ï¼ŒZè¡¨ç¤ºéšéšæœºå˜é‡çš„æ•°æ®ã€‚Yå’ŒZè¿åœ¨ä¸€èµ·ç§°ä¸ºå®Œå…¨æ•°æ®ã€‚å‡è®¾Yå’ŒZçš„è”åˆæ¦‚ç‡åˆ†å¸ƒä¸º
$$
P(Y,Z|\theta)
$$
åˆ™å®Œå…¨æ•°æ®çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸º
$$
logP(Y,Z|\theta)
$$
EMç®—æ³•é€šè¿‡è¿­ä»£æ±‚è§£
$$
L(\theta) = logP(Y|\theta)
$$
çš„æå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæ¥ä¼˜åŒ–å‚æ•°ã€‚



### EMç®—æ³•

è¾“å…¥ï¼šè§‚æµ‹å˜é‡Yï¼Œéšå˜é‡æ•°æ®Zï¼Œè”åˆåˆ†å¸ƒ$P(Y,Z|\theta)$ï¼Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$ P(Z|Y,\theta)$;

è¾“å‡ºï¼šå‚æ•°æ¨¡å‹$ \theta$ï¼›

ï¼ˆ1ï¼‰é€‰æ‹©å‚æ•°åˆå§‹å€¼$ {\theta}^{(0)}$ï¼Œå¼€å§‹è¿­ä»£ã€‚

ï¼ˆ2ï¼‰Eæ­¥ï¼šè®°$ {\theta}^{(i)} $ä¸ºç¬¬iæ¬¡è¿­ä»£å‚æ•°$\theta$çš„ä¼°è®¡å€¼ï¼Œåœ¨ç¬¬$i+1$æ¬¡è¿­ä»£çš„Eæ­¥ï¼Œè®¡ç®—
$$
Q(\theta,{\theta}^{(i)}) = E_Z[logP(Y,Z|\theta)|Y,{\theta}^{(i)}] = \sum_Z{P(Z|Y,{\theta}^{(i)})logP(Y,Z|\theta)}
$$
å…¶ä¸­$P(Z|Y,{\theta}^{(i)})$æ˜¯åœ¨ç»™å®šè§‚æµ‹æ•°æ®Yå’Œå½“å‰çš„å‚æ•°ä¼°è®¡${\theta}^{(i)}$ä¸‹éšå˜é‡Zçš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒã€‚

ï¼ˆ3ï¼‰Mæ­¥ï¼šæ±‚ä½¿å¾—$Q(\theta,{\theta}^{(i)})$æå¤§åŒ–çš„$\theta$,ç¡®å®šç¬¬i+1æ¬¡è¿­ä»£çš„å‚æ•°çš„ä¼°è®¡å€¼${\theta}^{(i+1)}$
$$
{\theta}^{(i+1)} = arg{\underset {\theta}{max} }Q(\theta,{\theta}^{(i)})
$$
ï¼ˆ4ï¼‰é‡å¤2ï¼Œ3ä¸¤æ­¥ï¼Œç›´åˆ°æ”¶æ•›ã€‚

Qå‡½æ•°ä¸ºï¼šå®Œå…¨æ•°æ®çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°$logP(Y,Z|\theta)$å…³äºåœ¨ç»™å®šè§‚æµ‹æ•°æ®Yå’Œå½“å‰å‚æ•°${\theta}^{(i)}$ä¸‹å¯¹æœªè§‚æµ‹æ•°æ®Zçš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$P(Z|Y,{\theta}^{(i)})$çš„æœŸæœ›ç§°ä¸º$Q$å‡½æ•°ï¼Œå³
$$
Q(\theta,{\theta}^{(i)}) = E_Z[logP(Y,Z|\theta)|Y,{\theta}^{(i)}]
$$
å‡ ç‚¹æ³¨æ„ï¼š

1. EMç®—æ³•å¯¹åˆå€¼æ•æ„Ÿ

2. è¿­ä»£åœæ­¢æ¡ä»¶ï¼Œä¸€èˆ¬æ˜¯å¯¹è¾ƒå°çš„æ­£æ•°${\epsilon}_1,{\epsilon}_2$,æ»¡è¶³
   $$
   ||{\theta}^{i+1} - {\theta}^i||<{\epsilon}_1 æˆ– ||Q(\theta^{i+1},{\theta}^{(i)})-Q(\theta^{i},{\theta}^{(i)})||<{\epsilon}_2
   $$

### EMç®—æ³•çš„å¯¼å‡ºï¼ˆå¯è¡Œæ€§è¯æ˜ï¼‰

å¯¹äºå«æœ‰éšå˜é‡çš„æ¦‚ç‡æ¨¡å‹ï¼Œç›®æ ‡æ˜¯æå¤§åŒ–è§‚æµ‹æ•°æ®ï¼ˆä¸å®Œå…¨æ•°æ®ï¼‰Yå…³äºå‚æ•°$\theta$çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼Œå³ï¼š
$$
L(\theta) = logP(Y|\theta) = log\sum_z{P(Y,Z|\theta)} = log(\sum_zP(Y|Z,\theta)P(Z|\theta))
$$
å‡è®¾ç¬¬iæ¬¡è¿­ä»£å$\theta$çš„ä¼°è®¡å€¼ä¸º${\theta}^i$,å¸Œæœ›æ–°çš„ä¼°è®¡å€¼å¢åŠ ï¼Œå³$L(\theta) > L({\theta}^i)$,å¹¶é€æ­¥è¾¾åˆ°æœ€å¤§å€¼ï¼Œæ­¤æ—¶ï¼Œè€ƒè™‘äºŒè€…å·®å€¼ï¼š
$$
L(\theta) - L({\theta}^i) = log(\sum_ZP(Y|Z,\theta)P(Z|\theta))-logP(Y|{\theta}^i)=log(\sum_ZP(Z|Y,{\theta}^i)\frac{P(Y|Z,\theta)P(Z|\theta)}{P(Z|Y,{\theta}^i)})-logP(Y|{\theta}^i)
$$
åˆ©ç”¨Jensenä¸ç­‰å¼
$$
log\sum_j{\lambda}_jy_j >= \sum_j{\lambda}_jlogy_i,å…¶ä¸­{\lambda}_j>=0,\sum_j{\lambda}_i=1
$$
å¾—åˆ°
$$
L(\theta)-L({\theta}^i) = log(\sum_ZP(Z|Y,{\theta}^i)\frac{P(Y|Z,\theta)P(Z|\theta)}{P(Z|Y,{\theta}^i)})-logP(Y|{\theta}^i)>=\sum_ZP(Z|Y,{\theta}^i)log\frac{P(Y|Z,\theta)P(Z|\theta)}{P(Z|Y,{\theta}^i)}-logP(Y|{\theta}^i)
$$
ç”±äº
$$
\sum_ZP(Z|Y,{\theta}^i) =1
$$

$$
logP(Y|{\theta}^i) = logP(Y|{\theta}^i) \sum_ZP(Z|Y,{\theta}^i)=\sum_ZP(Z|Y,{\theta}^i)P(Y|{\theta}^i)
$$

å› æ­¤
$$
L(\theta)-L({\theta}^i) >= \sum_ZP(Z|Y,{\theta}^i)log\frac{P(Y|Z,\theta)P(Z|\theta)}{P(Z|Y,{\theta}^i)P(Y|{\theta}^i)}
$$
ä»¤
$$
B(\theta,{\theta}^i)=L({\theta}^i)+\sum_ZP(Z|Y,{\theta}^i)log\frac{P(Y|Z,\theta)P(Z|\theta)}{P(Z|Y,{\theta}^i)P(Y|{\theta}^i)}
$$
åˆ™
$$
L(\theta)>=B(\theta,{\theta}^i)
$$
å‡½æ•°$B(\theta,{\theta}^i)$æ˜¯$L(\theta)$çš„ä¸‹ç•Œï¼Œå¹¶ä¸”æ ¹æ®ä¸Šé¢çš„å¼å­å¯å¾—$L({\theta}^i) = B(\theta,{\theta}^i)$ã€‚ä»»ä½•ä½¿å¾—Bå¢å¤§çš„$\theta$ï¼Œä¹Ÿå¯ä»¥ä½¿å¾—$L(\theta)$å¢å¤§ï¼Œé€‰æ‹©${\theta}^{i+1}$ä½¿å¾—Bè¾¾åˆ°æœ€å¤§ï¼Œå³
$$
{\theta}^{i+1}=arg\underset{ {\theta} }{max}B(\theta,{\theta}^i)
$$
çœåŒºå¯¹$\theta$çš„æå¤§åŒ–è€Œè¨€æ˜¯å¸¸æ•°çš„é¡¹ï¼Œåˆ™
$$
{\theta}^{i+1}=arg\underset{ {\theta} }{max}(L({\theta}^i)+\sum_ZP(Z|Y,{\theta}^i)log\frac{P(Y|Z,\theta)P(Z|\theta)}{P(Z|Y,{\theta}^i)P(Y|{\theta}^i)})\\=arg\underset{ {\theta} }{max}(\sum_ZP(Z|Y,{\theta}^i)log(P(Y|Z,\theta)P(Z|\theta)) = arg\underset{ {\theta} }{max}(\sum_ZP(Z|Y,{\theta}^i)logP(Y,Z|\theta))=arg\underset{ {\theta} }{max}Q(\theta,{\theta}^i)
$$

### EMç®—æ³•ç”ŸæˆHMMå‚æ•°ï¼ˆé²å§†-éŸ¦å°”å¥‡ç®—æ³•ï¼‰

è®­ç»ƒæ•°æ®ä¸º$\{(O_1,I_1),(O_2,I_2),...(O_D,I_D)\}$,å…¶ä¸­ä»»æ„è§‚æµ‹åºåˆ—$O_d=\{o_1^d,o_2^d,...o_T^d\}$ï¼Œå…¶å¯¹åº”çš„æœªçŸ¥çš„éšè—çŠ¶æ€åºåˆ—ä¸º$I_d=\{i_1^d,i_2^d,...I_T^d\}$ã€‚

ç®—æ³•Eæ­¥ï¼Œå…ˆè®¡ç®—è”åˆåˆ†å¸ƒ$P(O,I|\lambda)$,è¡¨è¾¾å¼å¦‚ä¸‹ï¼š
$$
P(O,I|\lambda)= \Pi_{d=1}^D{\pi}_{i_1^d}b_{i_1^d}(o_1^d)a_{i_1^d,i_2^d}b_{i_2^d}(o_2^d)...a_{i_{T-1}^d,i_T^d}b_{i_T^d}(o_T^d)
$$
å…¶ä¸­${\pi}_i$ä¸ºåˆå§‹çŠ¶æ€æ¦‚ç‡ï¼Œ$b_i(o)$ä¸ºå‘å°„æ¦‚ç‡ï¼Œ$a_{i_1,i_2}$ä¸ºè½¬ç§»æ¦‚ç‡ã€‚

Eæ­¥ä¸­æˆ‘ä»¬æ±‚å–æœŸæœ›ä¸º
$$
L(\lambda,\overline{\lambda})=\sum_IP(I|O,\overline{\lambda})logP(O,I|\lambda)
$$
åœ¨Mæ­¥ä¸­ï¼Œæˆ‘ä»¬è¦æå¤§åŒ–ä¸Šå¼ï¼Œ$P(I|O,\overline{\lambda})=\frac{P(I,O|\overline{\lambda})}{P(O|\overline{\lambda})}$,è€Œ$P(O|\overline{\lambda})$ä¸ºå¸¸æ•°ï¼Œå› æ­¤è¦æå¤§åŒ–çš„å¼å­ç­‰ä»·äº
$$
\overline{\lambda} = arg\underset{\lambda}{max}\sum_IP(O,I|\overline{\lambda})logP(O,I|\lambda)=arg\underset{\lambda}{max}\sum_{d=1}^D\sum_IP(O,I|\overline{\lambda})(log{\pi}_{i_1}+\sum_{t=1}^{T-1}loga_{i_t,i_{t+1} }+\sum_{t=1}^Tlogb_{i_t}(o_t))
$$
éšè—å‚æ•°$\lambda=(A,B,\Pi)$,ä¸Šå¼åˆ†åˆ«å¯¹$A,B,\Pi$æ±‚å¯¼å¯å¾—æ›´æ–°çš„å‚æ•°æ¨¡å‹$\overline{\lambda}$ã€‚

é¦–å…ˆçœ‹æ¨¡å‹å‚æ•°$\Pi$çš„å¯¼æ•°ã€‚ç”±äº$\Pi$åªåœ¨ç¬¬ä¸€éƒ¨åˆ†å‡ºç°ï¼Œå› æ­¤
$$
\overline{\pi}=arg\underset{ {\pi}_{i_1} }{max}\sum_{d=1}^D\sum_IP(O,I|\overline{\lambda})log{\pi}_{i_1}=arg\underset{ {\pi}_{i_1} }{max}\sum_{d=1}^D\sum_{i=1}^NP(O,i_1^d|\overline{\lambda})log{\pi}_{i_1}
$$
ç”±äº${\pi}_i$è¿˜æ»¡è¶³$\sum_{i=1}^N{\pi}_i=1$ï¼Œæ ¹æ®æ‹‰æ ¼æœ—æ—¥å­ä¹˜æ³•ï¼Œæˆ‘ä»¬å¾—åˆ°${\pi}_i$è¦æå¤§åŒ–çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸º
$$
arg\underset{ {\pi}_{i_1} }{max}\sum_{d=1}^D\sum_{i=1}^NP(O,i_1^d|\overline{\lambda})log{\pi}_{i_1}+\gamma(\sum_{i=1}^N{\pi}_i-1)
$$
å…¶ä¸­$\gamma$ä¸ºæ‹‰æ ¼æœ—æ—¥ç³»æ•°ï¼Œä¸Šå¼å¯¹${\pi}_1$æ±‚åå¯¼ï¼Œå¹¶ä»¤ç»“æœä¸º0ï¼Œå¾—åˆ°
$$
\sum_{d=1}^DP(O,i_1^d=i|\overline{\lambda})+\gamma{\pi}_i=0
$$
ä»¤iä»1åˆ°Nï¼Œä»ä¸Šå¼å¯ä»¥å¾—åˆ°Nä¸ªå¼å­ï¼Œå¯¹Nä¸ªå¼å­æ±‚å’Œå¯å¾—
$$
\sum_{d=1}^DP(O|\overline{\lambda})+\gamma=0
$$
ä¸Šé¢ä¸¤å¼æ¶ˆå»$\gamma$å¾—
$$
{\pi}_i=\frac{\sum_{d=1}^DP(O,i_1^d=i|\lambda)}{\sum_{d=1}^DP(O|\lambda)}=\frac{\sum_{d=1}^DP(O,i_1^d=i|\lambda)}{DP(O|\lambda)}=\frac{\sum_{d=1}^DP(i_1^d=i|O,\lambda)}{D}\\=\frac{\sum_{d=1}^DP(i_1^d=i|O^d,\lambda)}{D}=\frac{\sum_{d=1}^D{\gamma}_1^{(d)}(i)}{D}
$$
å†æ¥çœ‹$A$çš„è¿­ä»£å…¬å¼ï¼Œæ–¹æ³•å’Œ$\Pi$çš„ç±»ä¼¼ï¼Œç”±äº$A$åªåœ¨æœ€å¤§åŒ–å‡½æ•°é‡Œçš„ç¬¬äºŒéƒ¨åˆ†å‡ºç°ï¼Œå› æ­¤ï¼š
$$
\sum_{d=1}^D\sum_I\sum_{t=1}^{T-1}P(O,I|\overline{\lambda})loga_{i_t,i_{t+1} }\\=\sum_{d=1}^D\sum_{i=1}^N\sum_{j=1}^N\sum_{t=1}^{T-1}P(O,i_t^{d}=i,i_{t+1}^d=j|\overline{\lambda})loga_{ij}
$$
ç”±äº$a_{ij}$æ»¡è¶³$\sum_{j=1}^Na_{ij}=1$ã€‚å› æ­¤è¦æœ€å¤§åŒ–çš„å¼å­ä¸ºï¼š
$$
\sum_{d=1}^D\sum_{i=1}^N\sum_{j=1}^N\sum_{t=1}^{T-1}P(O,i_t^{d}=i,i_{t+1}^d=j|\overline{\lambda})loga_{ij}+\sum_{k=1}^N(\eta_k(\sum_{j=1}^Na_{ij}-1))
$$
å¯¹ä¸Šå¼çš„$a_{ij}$æ±‚åå¯¼ï¼Œå¹¶ä½¿å¯¼æ•°ä¸º0ï¼Œå¾—ï¼š
$$
\sum_{d=1}^D\sum_{t=1}^{T-1}P(O,i_t^{d}=i,i_{t+1}^d=j|\overline{\lambda})+\sum_{k=1}^N{\eta}_ka_{ij}=0
$$
ä¸${\pi}_i$ç±»ä¼¼ï¼Œå¯¹æ‰€æœ‰Nä¸ªå¼å­æ±‚å’Œå¯å¾—ï¼š
$$
\sum_{d=1}^D\sum_{t=1}^{T-1}P(O,i_t^{d}=i|\overline{\lambda})+\sum_{k=1}^N{\eta}_i=0
$$
å› æ­¤ï¼š
$$
a_{i,j}=\frac{\sum_{d=1}^D\sum_{t=1}^{T-1}P(O,i_t^{d}=i,i_{t+1}^d=j|\overline{\lambda})}{\sum_{d=1}^D\sum_{t=1}^{T-1}P(O,i_t^{d}=i|\overline{\lambda})}\\=\frac{\sum_{d=1}^D\sum_{t=1}^{T-1}P(i_t^{d}=i,i_{t+1}^d=j|O,\overline{\lambda})P(O|\overline{\lambda})}{\sum_{d=1}^D\sum_{t=1}^{T-1}P(i_t^{d}=i|O,\overline{\lambda})P(O|\overline{\lambda})}\\=\frac{\sum_{d=1}^D\sum_{t=1}^{T-1}P(i_t^{d}=i,i_{t+1}^d=j|O,\overline{\lambda})}{\sum_{d=1}^D\sum_{t=1}^{T-1}P(i_t^{d}=i|O,\overline{\lambda})}\\\frac{\sum_{d=1}^D\sum_{t=1}^{T-1}P(i_t^{d}=i,i_{t+1}^d=j|O^d,\overline{\lambda})}{\sum_{d=1}^D\sum_{t=1}^{T-1}P(i_t^{d}=i|O^d,\overline{\lambda})}\\=\frac{\sum_{d=1}^D\sum_{t=1}^{T-1}{\xi}_t^d(i,j)}{\sum_{d=1}^D\sum_{t=1}^{T-1}{\gamma}_t^d(i)}
$$
æœ€åçœ‹Bçš„è¿­ä»£å…¬å¼ï¼š
$$
\sum_{d=1}^D\sum_I\sum_{t=1}^TP(O,I|\overline{\lambda})logb_{i_t}(o_t)=\sum_{d=1}^D\sum_{j=1}^N\sum_{t=1}^TP(O,i_t^d=j|\overline{\lambda})logb_{i_t}(o_t)
$$
åˆç”±äº$\sum_{k=1}^Mb_j(o_t=v_k)=1$ï¼Œå› æ­¤ï¼Œä¸æ±‚aæ—¶ç±»ä¼¼ï¼š
$$
\sum_{d=1}^D\sum_{j=1}^N\sum_{t=1}^TP(O,i_t^d=j|\overline{\lambda})logb_{i_t}(o_t)+\sum_{p=1}^N(\eta_p(\sum_{k=1}^Mb_j(o_t=v_k)-1))
$$
åªæœ‰åœ¨$o_t=v_k$æ—¶ï¼Œ$b_j(o_t)$å¯¹$b_j(k)$çš„åå¯¼æ•°æ‰ä¸ä¸º0ï¼Œä½¿ç”¨$I(o_t=v_k)$è¡¨ç¤ºï¼Œå› æ­¤å¯¹ä¸Šå¼æ±‚å¯¼å¾—ï¼š
$$
\sum_{d=1}^D\sum_{t=1}^TP(O,i_t^d=j|\overline{\lambda})I(o_t=v_k)+\sum_{p=1}^N{\eta}_pb_j(o_t=v_k)=0
$$
ä¸ä¹‹å‰ç±»ä¼¼ï¼Œå¯¹æ‰€æœ‰Mä¸ªå¼å­æ±‚å’Œï¼Œå¾—åˆ°ï¼š
$$
\sum_{d=1}^D\sum_{t=1}^TP(O,i_t^d=j|\overline{\lambda})+\sum_{p=1}^N{\eta}_p=0
$$
å› æ­¤ï¼š
$$
b_j(k)=\frac{\sum_{d=1}^D\sum_{t=1}^TP(O,i_t^d=j|\overline{\lambda})I(o_t=v_k)}{\sum_{d=1}^D\sum_{t=1}^TP(O,i_t^d=j|\overline{\lambda})} = \frac{\sum_{d=1}^D\sum_{t=1,o_t^d=v_k}^T{\gamma}_t^d(j)}{\sum_{d=1}^D\sum_{t=1}^T{\gamma}_t^d(j)}
$$
ç”±æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ¨¡å‹$\lambda=(A,B,\Pi)$è¿­ä»£å…¬å¼ã€‚

æ€»ç»“æ•´ä½“æµç¨‹ï¼š

è¾“å…¥ï¼šDä¸ªè§‚å¯Ÿæ ·æœ¬$\{O_1,O_2,...O_D\}$

è¾“å‡ºï¼šHMMæ¨¡å‹å‚æ•°

1. éšæœºåˆå§‹åŒ–æ‰€æœ‰${\pi}_i,a_{ij},b_j(k)$ã€‚

2. å¯¹æ¯ä¸ªæ ·æœ¬$d=1,2,...D$ï¼Œç”¨å‰å‘åå‘ç®—æ³•è®¡ç®—${\gamma}_t^d(i),{\xi}_{t}^d(i,j);t=1,2,...T;i=1,2...N;j=1,2,...N$ã€‚

3. æ›´æ–°æ¨¡å‹å‚æ•°ï¼š
   $$
   {\pi}_i =\frac{\sum_{d=1}^D{\gamma}_1^{(d)}(i)}{D} \\
   a_{ij}=\frac{\sum_{d=1}^D\sum_{t=1}^{T-1}{\xi}_t^d(i,j)}{\sum_{d=1}^D\sum_{t=1}^{T-1}{\gamma}_t^d(i)}\\
   b_j(k)=\frac{\sum_{d=1}^D\sum_{t=1,o_t^d=v_k}^T{\gamma}_t^d(j)}{\sum_{d=1}^D\sum_{t=1}^T{\gamma}_t^d(j)}
   $$

4. å¦‚æœå‚æ•°å€¼å·²æ”¶æ•›ï¼Œåˆ™åœæ­¢è¿­ä»£ï¼Œè¾“å‡ºæ¨¡å‹ï¼Œå¦åˆ™é‡å¤2ï¼Œ3æ­¥ã€‚

## CRF(æ¡ä»¶éšæœºåœº)

